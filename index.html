<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta http-equiv="Cache-Control" content="public, max-age=3600" />
    <meta http-equiv="Pragma" content="cache" />
    <meta http-equiv="Expires" content="3600" />
    <title>Ahona Islam â€” Admin Panel</title>
    <link rel="stylesheet" href="style.css" />
    <link rel="icon" href="data:," />
  </head>
  <body class="dark">
    <script src="init-theme.js"></script>
    <header class="topBar" id="topBar">
      <div class="brand">Ahona Islam â€” Admin Panel</div>
      <button class="hamburger" id="hamburger" aria-label="Toggle menu">
        <span></span>
        <span></span>
        <span></span>
      </button>

      <div class="controls" id="controls">
        <!-- Mobile Tab Navigation (shown inside hamburger drawer) -->
        <nav class="mobileTabNav" aria-label="Mobile navigation">
          <button class="tabBtn" data-tab="editorTab">âœï¸ Write</button>
          <button class="tabBtn" data-tab="published">ğŸ“š Published</button>
          <button class="tabBtn" data-tab="drafts">ğŸ“ Drafts</button>
          <button class="tabBtn" data-tab="analytics">ğŸ“Š Stats</button>
        </nav>

        <div class="userArea" id="userArea">
          <button id="toggleTheme" aria-label="Toggle theme">â˜€ï¸</button>
          <select id="langSelect" aria-label="Language" title="Language" style="margin-left:8px;padding:6px;border-radius:8px;border:2px solid var(--border);background:transparent;color:var(--text);">
            <option value="en">EN</option>
            <option value="bn">à¦¬à¦¾à¦‚à¦²à¦¾</option>
          </select>
          <div id="currentUserName" class="username"></div>

          <button id="profileBtn" class="profileBtn">ğŸ‘¤ Profile</button>
          <button id="logoutBtn" class="logoutBtn">Log out</button>
        </div>
      </div>
    </header>

    <main class="container" id="mainContainer">
      <!-- Write/Editor Tab -->
      <section id="editorTab" class="tab-content active">
        <section class="editor card">
          <div class="editorHeader">
            <div>
              <h2>âœï¸ Write a New Story</h2>
              <p class="editorSubtitle">
                Share your thoughts, feelings, and moments
              </p>
            </div>
            <div class="editorStats">
              <span id="editorStatus" class="statusBadge">âš ï¸ Unsaved</span>
              <span id="lastSavedAt" class="lastSaved">Last saved: â€”</span>
            </div>
          </div>

          <input
            id="title"
            class="titleInput"
            type="text"
            placeholder="Give your story a compelling title..."
          />

          <div class="metaRow">
            <label class="metaLabel">
              Category
              <select id="category">
                <option value="">â€” select category â€”</option>
                <option value="Novel">ğŸ“– Novel</option>
                <option value="Poem">âœï¸ Poem</option>
                <option value="Short Story">ğŸ“ Short Story</option>
              </select>
            </label>
            <label class="metaLabel">
              ğŸ­ Mood
              <select id="mood">
                <option value="">â€” select mood â€”</option>
                <option value="Pain">ğŸ’” Pain</option>
                <option value="Love">â¤ï¸ Love</option>
                <option value="Silence">ğŸ¤« Silence</option>
                <option value="Hope">âœ¨ Hope</option>
              </select>
            </label>
            <label class="metaLabel">
              ğŸ·ï¸ Tags
              <input
                id="tags"
                type="text"
                placeholder="Add tags (comma separated)"
              />
            </label>
            <div class="readingEst">
              â±ï¸ <span id="readingEst">0 min</span> read
            </div>
            <label class="metaLabel">
              ğŸ¯ Goal (words)
              <input
                id="wordGoal"
                type="number"
                min="50"
                step="50"
                placeholder="e.g., 500"
              />
            </label>
            <label class="metaLabel">
              âœ¨ Template
              <select id="templateSelect">
                <option value="">â€” insert template â€”</option>
                <option value="poem">Poem Starter</option>
                <option value="shortStory">Short Story Outline</option>
                <option value="novel">Novel Chapter Starter</option>
                <option value="loveLetter">Love Letter</option>
              </select>
            </label>
          </div>

          <div class="toolbar" role="toolbar" aria-label="Text formatting">
            <div class="toolbarGroup">
              <button data-cmd="bold" title="Bold"><strong>B</strong></button>
              <button data-cmd="italic" title="Italic"><em>I</em></button>
              <button data-cmd="underline" title="Underline"><u>U</u></button>
              <button data-cmd="strikethrough" title="Strikethrough">
                <s>S</s>
              </button>
            </div>
            <div class="toolbarDivider"></div>
            <div class="toolbarGroup">
              <button data-cmd="createUnorderedList" title="Bullet list">
                â€¢ List
              </button>
              <button data-cmd="createOrderedList" title="Numbered list">
                1. List
              </button>
            </div>
            <div class="toolbarDivider"></div>
            <div class="toolbarGroup">
              <button data-cmd="formatBlock" data-value="h2" title="Heading">
                H2
              </button>
              <button data-cmd="formatBlock" data-value="h3" title="Subheading">
                H3
              </button>
              <button
                data-cmd="formatBlock"
                data-value="blockquote"
                title="Quote"
              >
                â Quote
              </button>
            </div>
            <div class="toolbarDivider"></div>
            <div class="toolbarGroup">
              <button data-cmd="undo" title="Undo">â†¶</button>
              <button data-cmd="redo" title="Redo">â†·</button>
            </div>
          </div>

          <div
            id="editorArea"
            class="editorArea"
            contenteditable="true"
            aria-label="Story content"
            placeholder="Write your story here... You can use the formatting tools above."
          ></div>

          <div class="charCount">
            <span id="charCount">0</span> characters Â·
            <span id="wordCount">0</span> words Â·
            <span id="paragraphCount">0</span> paragraphs
          </div>

          <div class="goalTracker">
            <div class="goalInfo">
              <span id="goalText">Goal: 0 words</span>
              <span id="goalPercent">0%</span>
            </div>
            <div class="goalBar">
              <div id="goalBarFill"></div>
            </div>
          </div>

          <div class="editorActions">
            <button id="saveDraft" class="btnSecondary">
              ğŸ’¾ Save as Draft
            </button>
            <button id="publish" class="btnPrimary">ğŸš€ Publish Story</button>
            <button id="preview" class="btnTertiary">ğŸ‘ï¸ Preview</button>
            <button id="restoreBackup" class="btnSecondary">
              â™»ï¸ Restore Backup
            </button>
            <button id="clear" class="btnDanger">ğŸ—‘ï¸ Clear</button>
          </div>
        </section>

        <!-- Preview Modal -->
        <div id="previewModal" class="modal hidden">
          <div class="modalContent">
            <div class="modalHeader">
              <h3>ğŸ“– Story Preview</h3>
              <button id="closePreview" class="closeBtn">âœ•</button>
            </div>
            <div id="previewContent" class="modalBody"></div>
          </div>
        </div>
      </section>

      <!-- Published Posts Tab -->
      <section id="published" class="tab-content">
        <div class="sectionHeader">
          <h2>Published Stories</h2>
          <input
            id="searchPublished"
            type="text"
            placeholder="Search stories..."
            class="searchInput"
          />
          <select
            id="filterPublishedCategory"
            class="categoryFilter"
            aria-label="Filter by category"
          >
            <option value="">All Categories</option>
            <option value="Novel">ğŸ“– Novel</option>
            <option value="Poem">âœï¸ Poem</option>
            <option value="Short Story">ğŸ“ Short Story</option>
          </select>
        </div>
        <div id="publishedPosts" class="postsList"></div>
      </section>

      <!-- Drafts Tab -->
      <section id="drafts" class="tab-content">
        <div class="sectionHeader">
          <h2>Draft Stories</h2>
          <span class="draftCount"
            >Total: <strong id="draftCountNum">0</strong></span
          >
          <input
            id="searchDrafts"
            type="text"
            placeholder="Search drafts..."
            class="searchInput"
          />
          <select
            id="filterDraftsCategory"
            class="categoryFilter"
            aria-label="Filter drafts by category"
          >
            <option value="">All Categories</option>
            <option value="Novel">ğŸ“– Novel</option>
            <option value="Poem">âœï¸ Poem</option>
            <option value="Short Story">ğŸ“ Short Story</option>
          </select>
        </div>
        <div id="draftPosts" class="postsList"></div>
      </section>

      <!-- Analytics Tab -->
      <section id="analytics" class="tab-content">
        <h2>Dashboard & Statistics</h2>
        <div class="statsGrid">
          <div class="statCard">
            <div class="statNumber" id="totalPosts">0</div>
            <div class="statLabel">Total Stories</div>
          </div>
          <div class="statCard">
            <div class="statNumber" id="totalDrafts">0</div>
            <div class="statLabel">Drafts</div>
          </div>
          <div class="statCard">
            <div class="statNumber" id="totalLikes">0</div>
            <div class="statLabel">Total Likes</div>
          </div>
          <div class="statCard">
            <div class="statNumber" id="totalComments">0</div>
            <div class="statLabel">Comments</div>
          </div>
          <div class="statCard">
            <div class="statNumber" id="totalReaders">0</div>
            <div class="statLabel">Readers</div>
          </div>
          <div class="statCard">
            <div class="statNumber" id="avgReadingTime">0</div>
            <div class="statLabel">Avg Reading Time</div>
          </div>
        </div>

        <div class="analyticsSection">
          <h3>Recent Activity</h3>
          <div id="recentActivity" class="activityList"></div>
        </div>

        <div class="analyticsSection">
          <h3>Top Stories</h3>
          <div id="topStories" class="topStoriesList"></div>
        </div>
      </section>
    </main>

    <!-- Blur overlay shown until login -->
    <div id="blurOverlay" class="blurOverlay hidden"></div>

    <!-- Profile Modal -->
    <div id="profileModal" class="modal hidden">
      <div class="modalContent profileModalContent">
        <div class="modalHeader">
          <h3>Profile & Account</h3>
          <button id="closeProfile" class="closeBtn">âœ•</button>
        </div>
        <div id="profileContent" class="modalBody"></div>
      </div>
    </div>

    <!-- Auth Modal (for login if logged out) -->
    <div id="authModal" class="modal hidden">
      <div class="modalContent authModalContent">
        <div class="authModalBg"></div>
        <div class="authModalInner">
          <div class="authHeader">
            <h2 id="authTitle">ğŸ” Admin Login</h2>
            <p class="authSubtitle">Access admin panel</p>
          </div>

          <form id="authForm" class="authForm">
            <div class="formGroup">
              <label for="authUsername">ï¿½ Email</label>
              <input
                id="authUsername"
                type="email"
                placeholder="Enter your email"
                required
              />
            </div>

            <div class="formGroup">
              <label for="authPassword">ğŸ” Password</label>
              <input
                id="authPassword"
                type="password"
                placeholder="Enter admin password"
                required
              />
            </div>

            <button type="submit" id="authSubmit" class="authSubmitBtn">
              Sign In âœ¨
            </button>

            <div class="authToggleWrapper">
              <span id="authToggleText">Don't have an account?</span>
              <a href="#" id="authToggleLink" class="authToggleLink"
                >Register here</a
              >
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmModal" class="modal hidden">
      <div class="modalContent confirmModalContent">
        <div class="modalHeader">
          <h3 id="confirmTitle">Confirm Action</h3>
        </div>
        <div class="modalBody">
          <p id="confirmMessage" class="confirmMessage"></p>
        </div>
        <div class="modalFooter">
          <button id="confirmCancel" class="btnSecondary">Cancel</button>
          <button id="confirmOk" class="btnDanger">Confirm</button>
        </div>
      </div>
    </div>

    <!-- Full Post Modal -->
    <div id="fullPostModal" class="modal hidden">
      <div class="modalContent fullPostModalContent">
        <div class="modalHeader">
          <h3 id="fullPostTitle">Post</h3>
          <button id="closeFullPost" class="closeBtn">âœ•</button>
        </div>
        <div id="fullPostBody" class="modalBody fullPostBody"></div>
      </div>
    </div>
  </body>
  <script type="module" src="script-firebase.js"></script>
  <script src="script.js"></script>
</html>
